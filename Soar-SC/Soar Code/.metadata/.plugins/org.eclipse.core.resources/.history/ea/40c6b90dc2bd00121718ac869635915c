sp {propose*build-barracks
   (state <state> ^name Soar-SC
              ^superstate nil
              ^io.input-link <input-link>
              ^io.output-link <output-link>
              ^buildings.building <building>
              ^minerals-budget <minerals-budget>
              ^gas-budget <gas-budget>)
   (<input-link> ^minerals <minerals> > 149
                 ^units.unit <build-unit>
                 ^types.type <scv-type>
                 ^types.type <barracks-type>)
   (<scv-type> ^name |Terran SCV|
               ^id <type-id>)
   (<build-unit> ^type <type-id>
                 ^idle <idle>
                 ^carrying <carrying>
                 ^id <id>
                -^scouting)
   (<barracks-type> ^name |Terran Barracks|
                    ^id <barracks-id>
                    ^mineral-cost { <= <minerals-budget> }
                    ^gas-cost { <= <gas-budget> })
   (<building> ^type <barracks-id>
               ^count { <l> < 4 })
   -{(<input-link> ^units.unit <unit>)
     (<unit> ^constructing <barracks-id>)}
   -{(<output-link> ^build-building <build-building>)
     (<build-building> ^type <barracks-id>
                         -^status)}
-->
   (<state> ^operator <operator> + =)
   (<operator> ^name build-building
               ^worker <id>
               ^idle <idle>
               ^carrying <carrying>
               ^location <l>
               ^type <barracks-id>)
}

#Preference rules

sp {pref*building-barracks-better-than-gather-minerals
   (state <s> ^operator <o1> +
              ^operator <o2> +
              ^io.input-link.types.type <t>)
   (<t> ^name |Terran Barracks|
        ^id <type-id>)
   (<o1> ^name build-building
         ^type <type-id>)
   (<o2> ^name gather-minerals)
-->
   (<s> ^operator <o1> > <o2>)
}

#Elaboration Rules

#sp {elaboration*barracks*location-to-x-y-0
#   (state <s> ^operator <o> +
#              ^io.input-link.types.type <t>)
#   (<t> ^name |Terran Barracks|
#        ^id <type-id>)
#   (<o> ^name build-building
#        ^type <type-id>
#        ^location 0)
#-->
#   (<o> ^location-x 40
#        ^location-y 60)
#}
#
#sp {elaboration*barracks*location-to-x-y-1
#   (state <s> ^operator <o> +
#              ^io.input-link.types.type <t>)
#   (<t> ^name |Terran Barracks|
#        ^id <type-id>)
#   (<o> ^name build-building
#        ^type <type-id>
#        ^location 1)
#-->
#   (<o> ^location-x 44
#        ^location-y 60)
#}
#
#sp {elaboration*barracks*location-to-x-y-2
#   (state <s> ^operator <o> +
#              ^io.input-link.types.type <t>)
#   (<t> ^name |Terran Barracks|
#        ^id <type-id>)
#   (<o> ^name build-building
#        ^type <type-id>
#        ^location 2)
#-->
#   (<o> ^location-x 48
#        ^location-y 60)
#}
#
#sp {elaboration*barracks*location-to-x-y-3
#   (state <s> ^operator <o> +
#              ^io.input-link.types.type <t>)
#   (<t> ^name |Terran Barracks|
#        ^id <type-id>)
#   (<o> ^name build-building
#        ^type <type-id>
#        ^location 3)
#-->
#   (<o> ^location-x 52
#        ^location-y 60)
#}