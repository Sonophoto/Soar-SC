sp {apply*build-unit
   (state <s> ^operator <op>
              ^io.output-link <o>)
   (<op> ^name build-unit
         ^location <id>
         ^type <type-id>)
-->
   (<o> ^build-unit <b>)
   (<b> ^type <type-id>
        ^building <id>)
}

#Preference rules

sp {pref*build-unit-better-than-gather-minerals
   (state <s> ^operator <o1> +
              ^operator <o2> +)
   (<o1> ^name build-unit)
   (<o2> ^name gather-minerals)
-->
   (<s> ^operator <o1> > <o2>)
}

sp {pref*remove-build-unit-operator-after-building
   (state <s> ^operator <op> +
              ^io.output-link.build-building <b>)
   (<op> ^name build-building
         ^type <type-id>)
   (<b> ^type <type-id>
       -^status)
-->
   (<s> ^operator <op> -)
}
